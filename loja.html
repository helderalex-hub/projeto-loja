<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagn√≥stico da Loja</title>
    <style>
        body { font-family: sans-serif; background-color: #fdf2f8; text-align: center; color: #333; }
        .erro-box { background: #ffe6e6; color: red; padding: 20px; border: 2px solid red; margin: 20px; font-weight: bold; }
        .vitrine { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; padding: 20px; }
        .card { background: white; padding: 20px; border-radius: 10px; width: 200px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
    </style>
</head>
<body>

    <h1>üõ†Ô∏è Modo de Diagn√≥stico üõ†Ô∏è</h1>
    <p>Se houver um erro, ele vai aparecer abaixo:</p>

    <div id="debug-log">Carregando sistema...</div>

    <div class="vitrine" id="vitrine"></div>

    <script>
        const logDiv = document.getElementById('debug-log');
        
        // 1. Fun√ß√£o que captura erros globais (Tela Branca)
        window.onerror = function(message, source, lineno, colno, error) {
            logDiv.innerHTML += `<div class="erro-box">ERRO CR√çTICO: ${message} <br> Linha: ${lineno}</div>`;
            return false;
        };

        // 2. Tenta conectar
        const API = 'https://projeto-loja-dzqv.onrender.com/produtos'; 

        async function carregar() {
            try {
                logDiv.innerHTML += "<br>üîÑ Tentando buscar dados no Render...";
                
                const response = await fetch(API);
                
                if (!response.ok) {
                    throw new Error(`O Servidor respondeu com erro: ${response.status}`);
                }

                const produtos = await response.json();
                logDiv.innerHTML += `<br>‚úÖ Sucesso! Recebi ${produtos.length} produtos.`;

                const divVitrine = document.getElementById('vitrine');
                
                produtos.forEach(p => {
                    divVitrine.innerHTML += `
                    <div class="card">
                        <h3>${p.nome}</h3>
                        <p>R$ ${p.preco}</p>
                    </div>`;
                });

            } catch (erro) {
                // Aqui capturamos erro de conex√£o (CORS ou Internet)
                logDiv.innerHTML += `<div class="erro-box">FALHA NO FETCH: ${erro.message}</div>`;
                logDiv.innerHTML += `<p>DICA: Se o erro for "Failed to fetch", √© problema de CORS no servidor.</p>`;
            }
        }

        carregar();
    </script>
</body>
</html>
